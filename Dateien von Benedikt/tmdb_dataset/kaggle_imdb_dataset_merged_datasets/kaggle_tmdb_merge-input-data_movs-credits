{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f310a561-f6b7-4172-8756-eb335b1a4b98",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Import Data from\n",
    "# tmdb_filmdaten_2025-02-17_20-22-06"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "340b15f1-14e5-4ba6-9606-304b283b1e27",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "33d123a5-54d3-4981-8a2c-60b6d5622db7",
   "metadata": {},
   "source": [
    "## Import der Tmdb Daten aus API Call "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "id": "c416f1cf-d4a2-46c0-ab67-211741aa711e",
   "metadata": {},
   "outputs": [],
   "source": [
    "tmdb_api_movies = pd.read_csv(\"../tmdb_api/tmdb_filmdaten_2025-02-17_20-22-06.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "id": "8e78982c-890a-4707-9866-50397ea31a68",
   "metadata": {
    "collapsed": true,
    "jupyter": {
     "outputs_hidden": true
    },
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movie_id</th>\n",
       "      <th>budget</th>\n",
       "      <th>genres</th>\n",
       "      <th>homepage</th>\n",
       "      <th>keywords</th>\n",
       "      <th>original_language</th>\n",
       "      <th>original_title</th>\n",
       "      <th>overview</th>\n",
       "      <th>popularity</th>\n",
       "      <th>production_companies</th>\n",
       "      <th>...</th>\n",
       "      <th>runtime</th>\n",
       "      <th>spoken_languages</th>\n",
       "      <th>status</th>\n",
       "      <th>tagline</th>\n",
       "      <th>title</th>\n",
       "      <th>vote_average</th>\n",
       "      <th>vote_count</th>\n",
       "      <th>cast</th>\n",
       "      <th>crew</th>\n",
       "      <th>director</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>19995</td>\n",
       "      <td>237000000</td>\n",
       "      <td>Action, Adventure, Fantasy, Science Fiction</td>\n",
       "      <td>https://www.avatar.com/movies/avatar</td>\n",
       "      <td>paraplegic, attachment to nature, culture clas...</td>\n",
       "      <td>en</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>In the 22nd century, a paraplegic Marine is di...</td>\n",
       "      <td>51.743</td>\n",
       "      <td>Dune Entertainment, Lightstorm Entertainment, ...</td>\n",
       "      <td>...</td>\n",
       "      <td>162.0</td>\n",
       "      <td>English, Español</td>\n",
       "      <td>Released</td>\n",
       "      <td>Enter the world of Pandora.</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>7.588</td>\n",
       "      <td>31951</td>\n",
       "      <td>Sam Worthington, Zoe Saldaña, Sigourney Weaver...</td>\n",
       "      <td>James Cameron, James Cameron, Ilram Choi, Wood...</td>\n",
       "      <td>James Cameron</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>417859</td>\n",
       "      <td>130000000</td>\n",
       "      <td>Animation, Family, Fantasy, Adventure, Comedy</td>\n",
       "      <td>https://www.dreamworks.com/movies/puss-in-boots</td>\n",
       "      <td>small town, fairy tale, rebel, spin off, wild ...</td>\n",
       "      <td>en</td>\n",
       "      <td>Puss in Boots</td>\n",
       "      <td>Long before he even met Shrek, the notorious f...</td>\n",
       "      <td>15.960</td>\n",
       "      <td>DreamWorks Animation</td>\n",
       "      <td>...</td>\n",
       "      <td>90.0</td>\n",
       "      <td>Español, English</td>\n",
       "      <td>Released</td>\n",
       "      <td>Live for danger. Fight for justice. Pray for m...</td>\n",
       "      <td>Puss in Boots</td>\n",
       "      <td>6.600</td>\n",
       "      <td>4132</td>\n",
       "      <td>Antonio Banderas, Salma Hayek Pinault, Zach Ga...</td>\n",
       "      <td>Rich Dietl, Josh Wood, Bob Persichetti, Ken Bi...</td>\n",
       "      <td>Chris Miller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>13700</td>\n",
       "      <td>110000000</td>\n",
       "      <td>Animation, Family</td>\n",
       "      <td>http://movies.disney.com/home-on-the-range</td>\n",
       "      <td>farm, villain, outlaw, animals, dairy cow, tal...</td>\n",
       "      <td>en</td>\n",
       "      <td>Home on the Range</td>\n",
       "      <td>When a greedy outlaw schemes to take possessio...</td>\n",
       "      <td>14.692</td>\n",
       "      <td>Walt Disney Pictures, Walt Disney Feature Anim...</td>\n",
       "      <td>...</td>\n",
       "      <td>76.0</td>\n",
       "      <td>普通话, English</td>\n",
       "      <td>Released</td>\n",
       "      <td>Bust a Moo</td>\n",
       "      <td>Home on the Range</td>\n",
       "      <td>6.100</td>\n",
       "      <td>2058</td>\n",
       "      <td>Roseanne Barr, Judi Dench, Jennifer Tilly, Ste...</td>\n",
       "      <td>Carter Goodrich, John Sanford, Will Finn, Alic...</td>\n",
       "      <td>John Sanford, Will Finn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>262504</td>\n",
       "      <td>110000000</td>\n",
       "      <td>Adventure, Science Fiction, Action, Mystery</td>\n",
       "      <td>http://www.thedivergentseries.movie/#allegiant</td>\n",
       "      <td>based on novel or book, revolution, dystopia, ...</td>\n",
       "      <td>en</td>\n",
       "      <td>Allegiant</td>\n",
       "      <td>Beatrice Prior and Tobias Eaton venture into t...</td>\n",
       "      <td>12.029</td>\n",
       "      <td>Mandeville Films, Summit Entertainment, Lionsg...</td>\n",
       "      <td>...</td>\n",
       "      <td>120.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>The truth lies beyond the wall.</td>\n",
       "      <td>Allegiant</td>\n",
       "      <td>6.100</td>\n",
       "      <td>6661</td>\n",
       "      <td>Shailene Woodley, Theo James, Miles Teller, Zo...</td>\n",
       "      <td>Scott Christopher Kelly, Todd Lieberman, Gee A...</td>\n",
       "      <td>Robert Schwentke</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>257088</td>\n",
       "      <td>105000000</td>\n",
       "      <td>Action, Adventure, Crime, Thriller</td>\n",
       "      <td>https://www.facebook.com/PointBreakMovie</td>\n",
       "      <td>surfing, undercover agent, undercover, fbi, ex...</td>\n",
       "      <td>en</td>\n",
       "      <td>Point Break</td>\n",
       "      <td>A young undercover FBI agent infiltrates a gan...</td>\n",
       "      <td>8.354</td>\n",
       "      <td>Studio Babelsberg, Alcon Entertainment, DMG En...</td>\n",
       "      <td>...</td>\n",
       "      <td>114.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>Find your breaking point.</td>\n",
       "      <td>Point Break</td>\n",
       "      <td>6.000</td>\n",
       "      <td>2307</td>\n",
       "      <td>Edgar Ramírez, Luke Bracey, Teresa Palmer, Ray...</td>\n",
       "      <td>Ericson Core, Kurt Wimmer, Clay Cullen, Mic Ro...</td>\n",
       "      <td>Ericson Core</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>258509</td>\n",
       "      <td>90000000</td>\n",
       "      <td>Family, Adventure, Comedy, Music, Animation</td>\n",
       "      <td>http://www.foxmovies.com/movies/alvin-and-the-...</td>\n",
       "      <td>anthropomorphism, chipmunk, hitchhiker, afterc...</td>\n",
       "      <td>en</td>\n",
       "      <td>Alvin and the Chipmunks: The Road Chip</td>\n",
       "      <td>Through a series of misunderstandings, Alvin, ...</td>\n",
       "      <td>15.208</td>\n",
       "      <td>TSG Entertainment, Fox 2000 Pictures, Regency ...</td>\n",
       "      <td>...</td>\n",
       "      <td>92.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>Fast &amp; furry-ous</td>\n",
       "      <td>Alvin and the Chipmunks: The Road Chip</td>\n",
       "      <td>6.000</td>\n",
       "      <td>1647</td>\n",
       "      <td>Jason Lee, Justin Long, Matthew Gray Gubler, J...</td>\n",
       "      <td>Ross Bagdasarian, Jr., Janice Karman, Ross Bag...</td>\n",
       "      <td>Walt Becker</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>49852</td>\n",
       "      <td>90000000</td>\n",
       "      <td>Music, Fantasy, Family, Adventure</td>\n",
       "      <td>http://www.nutcrackerin3d.com/</td>\n",
       "      <td>nazi, fairy, musical, based on play or musical...</td>\n",
       "      <td>en</td>\n",
       "      <td>The Nutcracker</td>\n",
       "      <td>In 1920s Vienna, a young girl receives a magic...</td>\n",
       "      <td>7.134</td>\n",
       "      <td>Vnesheconombank, Nutcracker Holdings, HCC Medi...</td>\n",
       "      <td>...</td>\n",
       "      <td>108.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>Experience the Holiday Classic as You've Never...</td>\n",
       "      <td>The Nutcracker</td>\n",
       "      <td>5.100</td>\n",
       "      <td>189</td>\n",
       "      <td>Elle Fanning, Nathan Lane, John Turturro, Fran...</td>\n",
       "      <td>Andrei Konchalovsky, Peter Burgis, Andie Derri...</td>\n",
       "      <td>Andrei Konchalovsky</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>39691</td>\n",
       "      <td>85000000</td>\n",
       "      <td>Family, Adventure, Comedy, Fantasy, Action, An...</td>\n",
       "      <td>http://catsanddogsmovie.warnerbros.com/</td>\n",
       "      <td>torture, aftercreditsstinger, duringcreditssti...</td>\n",
       "      <td>en</td>\n",
       "      <td>Cats &amp; Dogs: The Revenge of Kitty Galore</td>\n",
       "      <td>The ongoing war between the canine and feline ...</td>\n",
       "      <td>7.505</td>\n",
       "      <td>Village Roadshow Pictures, Polymorphic Picture...</td>\n",
       "      <td>...</td>\n",
       "      <td>82.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>Just like real spies... only furrier.</td>\n",
       "      <td>Cats &amp; Dogs: The Revenge of Kitty Galore</td>\n",
       "      <td>5.200</td>\n",
       "      <td>643</td>\n",
       "      <td>James Marsden, Nick Nolte, Christina Applegate...</td>\n",
       "      <td>Brad Peyton, Ron J. Friedman, Steve Bencich, S...</td>\n",
       "      <td>Brad Peyton</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>330770</td>\n",
       "      <td>0</td>\n",
       "      <td>Mystery, Drama, Horror</td>\n",
       "      <td>NaN</td>\n",
       "      <td>sea, beach, nurse, pregnancy, woman director</td>\n",
       "      <td>fr</td>\n",
       "      <td>Évolution</td>\n",
       "      <td>11-year-old Nicolas lives with his mother in a...</td>\n",
       "      <td>6.709</td>\n",
       "      <td>Les films du Worso, Noodles Production, SCOPE ...</td>\n",
       "      <td>...</td>\n",
       "      <td>81.0</td>\n",
       "      <td>Français</td>\n",
       "      <td>Released</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Evolution</td>\n",
       "      <td>6.000</td>\n",
       "      <td>206</td>\n",
       "      <td>Max Brebant, Roxane Duran, Julie-Marie Parment...</td>\n",
       "      <td>Manuel Dacosse, Lucile Hadžihalilović, Lucile ...</td>\n",
       "      <td>Lucile Hadžihalilović</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>77951</td>\n",
       "      <td>80000000</td>\n",
       "      <td>Animation, Family, Adventure</td>\n",
       "      <td>http://www.walkingwithdinosaurs.com/movie/</td>\n",
       "      <td>hero, walking, brother, prehistory, dinosaur, ...</td>\n",
       "      <td>en</td>\n",
       "      <td>Walking with Dinosaurs</td>\n",
       "      <td>In a time when dinosaurs rule the Earth, the s...</td>\n",
       "      <td>7.762</td>\n",
       "      <td>Animal Logic, Evergreen Films, Reliance Entert...</td>\n",
       "      <td>...</td>\n",
       "      <td>87.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>The Greatest Adventure in 70 Million Years</td>\n",
       "      <td>Walking with Dinosaurs</td>\n",
       "      <td>6.200</td>\n",
       "      <td>477</td>\n",
       "      <td>Justin Long, John Leguizamo, Tiya Sircar, Skyl...</td>\n",
       "      <td>Jinko Gotoh, Neil Nightingale, Neil Nightingal...</td>\n",
       "      <td>Neil Nightingale, Barry Cook</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>10197</td>\n",
       "      <td>80000000</td>\n",
       "      <td>Drama, Music, Romance</td>\n",
       "      <td>http://nine-movie.com/</td>\n",
       "      <td>creative crisis, melancholy, memory, sidewalk ...</td>\n",
       "      <td>en</td>\n",
       "      <td>Nine</td>\n",
       "      <td>Arrogant, self-centered movie director Guido C...</td>\n",
       "      <td>7.101</td>\n",
       "      <td>Relativity Media, The Weinstein Company, Marc ...</td>\n",
       "      <td>...</td>\n",
       "      <td>118.0</td>\n",
       "      <td>English, Français, Italiano</td>\n",
       "      <td>Released</td>\n",
       "      <td>This Holiday Season, Be Italian.</td>\n",
       "      <td>Nine</td>\n",
       "      <td>5.500</td>\n",
       "      <td>598</td>\n",
       "      <td>Daniel Day-Lewis, Marion Cotillard, Penélope C...</td>\n",
       "      <td>Rob Marshall, Colleen Atwood, Michael Tolkin, ...</td>\n",
       "      <td>Rob Marshall</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>9992</td>\n",
       "      <td>86000000</td>\n",
       "      <td>Adventure, Fantasy, Animation, Family</td>\n",
       "      <td>NaN</td>\n",
       "      <td>grandparent grandchild relationship, wretch, t...</td>\n",
       "      <td>fr</td>\n",
       "      <td>Arthur et les Minimoys</td>\n",
       "      <td>Arthur is a spirited ten-year old whose parent...</td>\n",
       "      <td>10.452</td>\n",
       "      <td>EuropaCorp, Avalanche Productions, Apipoulaï P...</td>\n",
       "      <td>...</td>\n",
       "      <td>94.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>Adventure awaits in your own backyard.</td>\n",
       "      <td>Arthur and the Invisibles</td>\n",
       "      <td>6.400</td>\n",
       "      <td>2893</td>\n",
       "      <td>Freddie Highmore, Madonna, Mia Farrow, Jimmy F...</td>\n",
       "      <td>Luc Besson, Stéphane Lecomte, Luc Besson, Emma...</td>\n",
       "      <td>Luc Besson</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>76649</td>\n",
       "      <td>100000000</td>\n",
       "      <td>Action, Adventure, History, Romance, Drama</td>\n",
       "      <td>NaN</td>\n",
       "      <td>epic, lava, gladiator, arena, gladiator fight,...</td>\n",
       "      <td>en</td>\n",
       "      <td>Pompeii</td>\n",
       "      <td>In 79 A.D., Milo, a slave turned gladiator, fi...</td>\n",
       "      <td>8.873</td>\n",
       "      <td>Don Carmody Productions, Impact Pictures, Cons...</td>\n",
       "      <td>...</td>\n",
       "      <td>105.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>No warning. No escape.</td>\n",
       "      <td>Pompeii</td>\n",
       "      <td>5.500</td>\n",
       "      <td>3246</td>\n",
       "      <td>Kit Harington, Emily Browning, Adewale Akinnuo...</td>\n",
       "      <td>Tracy Shaw, Robert Johnson, Lee Batchler, Paul...</td>\n",
       "      <td>Paul W. S. Anderson</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>293644</td>\n",
       "      <td>8000000</td>\n",
       "      <td>Comedy, Animation, Family</td>\n",
       "      <td>NaN</td>\n",
       "      <td>prequel, based on cartoon</td>\n",
       "      <td>es</td>\n",
       "      <td>Don Gato: El Inicio de la Pandilla</td>\n",
       "      <td>Top Cat and his new feline friend hatch a sche...</td>\n",
       "      <td>7.025</td>\n",
       "      <td>Ánima Estudios, Discreet Arts Productions, Viv...</td>\n",
       "      <td>...</td>\n",
       "      <td>89.0</td>\n",
       "      <td>English, Español</td>\n",
       "      <td>Released</td>\n",
       "      <td>The gang is born</td>\n",
       "      <td>Top Cat Begins</td>\n",
       "      <td>6.700</td>\n",
       "      <td>146</td>\n",
       "      <td>Jason Harris, David Hoffman, Bill Lobley, Dari...</td>\n",
       "      <td>Jose C. Garcia de Letona, Leoncio Lara, Patric...</td>\n",
       "      <td>Andrés Couturier</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>15189</td>\n",
       "      <td>35000000</td>\n",
       "      <td>Comedy, Family</td>\n",
       "      <td>NaN</td>\n",
       "      <td>adoption, puppy, pitbull, dog, foster home, an...</td>\n",
       "      <td>en</td>\n",
       "      <td>Hotel for Dogs</td>\n",
       "      <td>Placed in a foster home that doesn't allow pet...</td>\n",
       "      <td>7.290</td>\n",
       "      <td>DreamWorks Pictures, Nickelodeon Movies, Cold ...</td>\n",
       "      <td>...</td>\n",
       "      <td>100.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>No stray gets turned away.</td>\n",
       "      <td>Hotel for Dogs</td>\n",
       "      <td>6.037</td>\n",
       "      <td>870</td>\n",
       "      <td>Emma Roberts, Jake T. Austin, Don Cheadle, Joh...</td>\n",
       "      <td>Thor Freudenthal, Matt McColm, Jake Rice, Greg...</td>\n",
       "      <td>Thor Freudenthal</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>25769</td>\n",
       "      <td>0</td>\n",
       "      <td>Action, Drama, Horror, Science Fiction, Thriller</td>\n",
       "      <td>NaN</td>\n",
       "      <td>beach, infection, survival, biohazard, disease...</td>\n",
       "      <td>en</td>\n",
       "      <td>Carriers</td>\n",
       "      <td>A deadly virus has spread across the globe. Co...</td>\n",
       "      <td>9.034</td>\n",
       "      <td>Paramount Vantage, Likely Story, This is that,...</td>\n",
       "      <td>...</td>\n",
       "      <td>84.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>The rules are simple. You break them, you die...</td>\n",
       "      <td>Carriers</td>\n",
       "      <td>6.059</td>\n",
       "      <td>1400</td>\n",
       "      <td>Lou Taylor Pucci, Chris Pine, Piper Perabo, Em...</td>\n",
       "      <td>Michael R. Williams, David Pastor, Robert Velo...</td>\n",
       "      <td>Àlex Pastor, David Pastor</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>228165</td>\n",
       "      <td>74000000</td>\n",
       "      <td>Family, Adventure, Comedy, Fantasy, Animation</td>\n",
       "      <td>http://www.spongebobmovie.com/</td>\n",
       "      <td>sea, ocean, villain, sequel, computer animatio...</td>\n",
       "      <td>en</td>\n",
       "      <td>The SpongeBob Movie: Sponge Out of Water</td>\n",
       "      <td>Burger Beard is a pirate who is in search of t...</td>\n",
       "      <td>16.156</td>\n",
       "      <td>Paramount Animation, Paramount Pictures, Nicke...</td>\n",
       "      <td>...</td>\n",
       "      <td>93.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>Making waves in our world.</td>\n",
       "      <td>The SpongeBob Movie: Sponge Out of Water</td>\n",
       "      <td>6.100</td>\n",
       "      <td>2374</td>\n",
       "      <td>Tom Kenny, Bill Fagerbakke, Rodger Bumpass, Cl...</td>\n",
       "      <td>Pharrell Williams, Chad Hugo, Shay Haley, Paul...</td>\n",
       "      <td>Paul Tibbitt, Mike Mitchell</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>59981</td>\n",
       "      <td>70000000</td>\n",
       "      <td>Animation, Family, Fantasy</td>\n",
       "      <td>http://www.dorothyofozthemovie.com/</td>\n",
       "      <td>musical</td>\n",
       "      <td>en</td>\n",
       "      <td>Legends of Oz: Dorothy's Return</td>\n",
       "      <td>Dorothy wakes up in post-tornado Kansas, only ...</td>\n",
       "      <td>7.115</td>\n",
       "      <td>Summertime Entertainment, Prana Animation Studios</td>\n",
       "      <td>...</td>\n",
       "      <td>88.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>There's trouble in OZ...</td>\n",
       "      <td>Legends of Oz: Dorothy's Return</td>\n",
       "      <td>6.300</td>\n",
       "      <td>367</td>\n",
       "      <td>Lea Michele, Dan Aykroyd, Jim Belushi, Kelsey ...</td>\n",
       "      <td>Dan St. Pierre, Adam Balsam, Randi Barnes, Rol...</td>\n",
       "      <td>Dan St. Pierre, Will Finn</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>188207</td>\n",
       "      <td>70000000</td>\n",
       "      <td>Action, Adventure</td>\n",
       "      <td>http://www.Hercules3DMovie.com</td>\n",
       "      <td>mythology, zeus, ancient greece, demigod, city...</td>\n",
       "      <td>en</td>\n",
       "      <td>The Legend of Hercules</td>\n",
       "      <td>In Ancient Greece 1200 B.C., a queen succumbs ...</td>\n",
       "      <td>8.373</td>\n",
       "      <td>Millennium Media, Summit Entertainment, Nu Boy...</td>\n",
       "      <td>...</td>\n",
       "      <td>99.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>Every man has a destiny.</td>\n",
       "      <td>The Legend of Hercules</td>\n",
       "      <td>4.800</td>\n",
       "      <td>1331</td>\n",
       "      <td>Kellan Lutz, Liam McIntyre, Gaia Weiss, Scott ...</td>\n",
       "      <td>Sonu Mishra, Renny Harlin, Trevor Short, Tuoma...</td>\n",
       "      <td>Renny Harlin</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>196867</td>\n",
       "      <td>65000000</td>\n",
       "      <td>Comedy, Drama, Family</td>\n",
       "      <td>NaN</td>\n",
       "      <td>new york city, child abuse, helicopter, musica...</td>\n",
       "      <td>en</td>\n",
       "      <td>Annie</td>\n",
       "      <td>Annie is a young, happy foster kid who's also ...</td>\n",
       "      <td>12.417</td>\n",
       "      <td>Marcy Media, Columbia Pictures, Olive Bridge E...</td>\n",
       "      <td>...</td>\n",
       "      <td>118.0</td>\n",
       "      <td>English</td>\n",
       "      <td>Released</td>\n",
       "      <td>It's a hard knock life</td>\n",
       "      <td>Annie</td>\n",
       "      <td>6.200</td>\n",
       "      <td>1283</td>\n",
       "      <td>Quvenzhané Wallis, Jamie Foxx, Rose Byrne, Cam...</td>\n",
       "      <td>Will Gluck, Aline Brosh McKenna, Jay-Z, Will S...</td>\n",
       "      <td>Will Gluck</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>20 rows × 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   movie_id     budget                                             genres  \\\n",
       "0     19995  237000000        Action, Adventure, Fantasy, Science Fiction   \n",
       "1    417859  130000000      Animation, Family, Fantasy, Adventure, Comedy   \n",
       "2     13700  110000000                                  Animation, Family   \n",
       "3    262504  110000000        Adventure, Science Fiction, Action, Mystery   \n",
       "4    257088  105000000                 Action, Adventure, Crime, Thriller   \n",
       "5    258509   90000000        Family, Adventure, Comedy, Music, Animation   \n",
       "6     49852   90000000                  Music, Fantasy, Family, Adventure   \n",
       "7     39691   85000000  Family, Adventure, Comedy, Fantasy, Action, An...   \n",
       "8    330770          0                             Mystery, Drama, Horror   \n",
       "9     77951   80000000                       Animation, Family, Adventure   \n",
       "10    10197   80000000                              Drama, Music, Romance   \n",
       "11     9992   86000000              Adventure, Fantasy, Animation, Family   \n",
       "12    76649  100000000         Action, Adventure, History, Romance, Drama   \n",
       "13   293644    8000000                          Comedy, Animation, Family   \n",
       "14    15189   35000000                                     Comedy, Family   \n",
       "15    25769          0   Action, Drama, Horror, Science Fiction, Thriller   \n",
       "16   228165   74000000      Family, Adventure, Comedy, Fantasy, Animation   \n",
       "17    59981   70000000                         Animation, Family, Fantasy   \n",
       "18   188207   70000000                                  Action, Adventure   \n",
       "19   196867   65000000                              Comedy, Drama, Family   \n",
       "\n",
       "                                             homepage  \\\n",
       "0                https://www.avatar.com/movies/avatar   \n",
       "1     https://www.dreamworks.com/movies/puss-in-boots   \n",
       "2          http://movies.disney.com/home-on-the-range   \n",
       "3      http://www.thedivergentseries.movie/#allegiant   \n",
       "4            https://www.facebook.com/PointBreakMovie   \n",
       "5   http://www.foxmovies.com/movies/alvin-and-the-...   \n",
       "6                      http://www.nutcrackerin3d.com/   \n",
       "7             http://catsanddogsmovie.warnerbros.com/   \n",
       "8                                                 NaN   \n",
       "9          http://www.walkingwithdinosaurs.com/movie/   \n",
       "10                             http://nine-movie.com/   \n",
       "11                                                NaN   \n",
       "12                                                NaN   \n",
       "13                                                NaN   \n",
       "14                                                NaN   \n",
       "15                                                NaN   \n",
       "16                     http://www.spongebobmovie.com/   \n",
       "17                http://www.dorothyofozthemovie.com/   \n",
       "18                     http://www.Hercules3DMovie.com   \n",
       "19                                                NaN   \n",
       "\n",
       "                                             keywords original_language  \\\n",
       "0   paraplegic, attachment to nature, culture clas...                en   \n",
       "1   small town, fairy tale, rebel, spin off, wild ...                en   \n",
       "2   farm, villain, outlaw, animals, dairy cow, tal...                en   \n",
       "3   based on novel or book, revolution, dystopia, ...                en   \n",
       "4   surfing, undercover agent, undercover, fbi, ex...                en   \n",
       "5   anthropomorphism, chipmunk, hitchhiker, afterc...                en   \n",
       "6   nazi, fairy, musical, based on play or musical...                en   \n",
       "7   torture, aftercreditsstinger, duringcreditssti...                en   \n",
       "8        sea, beach, nurse, pregnancy, woman director                fr   \n",
       "9   hero, walking, brother, prehistory, dinosaur, ...                en   \n",
       "10  creative crisis, melancholy, memory, sidewalk ...                en   \n",
       "11  grandparent grandchild relationship, wretch, t...                fr   \n",
       "12  epic, lava, gladiator, arena, gladiator fight,...                en   \n",
       "13                          prequel, based on cartoon                es   \n",
       "14  adoption, puppy, pitbull, dog, foster home, an...                en   \n",
       "15  beach, infection, survival, biohazard, disease...                en   \n",
       "16  sea, ocean, villain, sequel, computer animatio...                en   \n",
       "17                                            musical                en   \n",
       "18  mythology, zeus, ancient greece, demigod, city...                en   \n",
       "19  new york city, child abuse, helicopter, musica...                en   \n",
       "\n",
       "                              original_title  \\\n",
       "0                                     Avatar   \n",
       "1                              Puss in Boots   \n",
       "2                          Home on the Range   \n",
       "3                                  Allegiant   \n",
       "4                                Point Break   \n",
       "5     Alvin and the Chipmunks: The Road Chip   \n",
       "6                             The Nutcracker   \n",
       "7   Cats & Dogs: The Revenge of Kitty Galore   \n",
       "8                                  Évolution   \n",
       "9                     Walking with Dinosaurs   \n",
       "10                                      Nine   \n",
       "11                    Arthur et les Minimoys   \n",
       "12                                   Pompeii   \n",
       "13        Don Gato: El Inicio de la Pandilla   \n",
       "14                            Hotel for Dogs   \n",
       "15                                  Carriers   \n",
       "16  The SpongeBob Movie: Sponge Out of Water   \n",
       "17           Legends of Oz: Dorothy's Return   \n",
       "18                    The Legend of Hercules   \n",
       "19                                     Annie   \n",
       "\n",
       "                                             overview  popularity  \\\n",
       "0   In the 22nd century, a paraplegic Marine is di...      51.743   \n",
       "1   Long before he even met Shrek, the notorious f...      15.960   \n",
       "2   When a greedy outlaw schemes to take possessio...      14.692   \n",
       "3   Beatrice Prior and Tobias Eaton venture into t...      12.029   \n",
       "4   A young undercover FBI agent infiltrates a gan...       8.354   \n",
       "5   Through a series of misunderstandings, Alvin, ...      15.208   \n",
       "6   In 1920s Vienna, a young girl receives a magic...       7.134   \n",
       "7   The ongoing war between the canine and feline ...       7.505   \n",
       "8   11-year-old Nicolas lives with his mother in a...       6.709   \n",
       "9   In a time when dinosaurs rule the Earth, the s...       7.762   \n",
       "10  Arrogant, self-centered movie director Guido C...       7.101   \n",
       "11  Arthur is a spirited ten-year old whose parent...      10.452   \n",
       "12  In 79 A.D., Milo, a slave turned gladiator, fi...       8.873   \n",
       "13  Top Cat and his new feline friend hatch a sche...       7.025   \n",
       "14  Placed in a foster home that doesn't allow pet...       7.290   \n",
       "15  A deadly virus has spread across the globe. Co...       9.034   \n",
       "16  Burger Beard is a pirate who is in search of t...      16.156   \n",
       "17  Dorothy wakes up in post-tornado Kansas, only ...       7.115   \n",
       "18  In Ancient Greece 1200 B.C., a queen succumbs ...       8.373   \n",
       "19  Annie is a young, happy foster kid who's also ...      12.417   \n",
       "\n",
       "                                 production_companies  ... runtime  \\\n",
       "0   Dune Entertainment, Lightstorm Entertainment, ...  ...   162.0   \n",
       "1                                DreamWorks Animation  ...    90.0   \n",
       "2   Walt Disney Pictures, Walt Disney Feature Anim...  ...    76.0   \n",
       "3   Mandeville Films, Summit Entertainment, Lionsg...  ...   120.0   \n",
       "4   Studio Babelsberg, Alcon Entertainment, DMG En...  ...   114.0   \n",
       "5   TSG Entertainment, Fox 2000 Pictures, Regency ...  ...    92.0   \n",
       "6   Vnesheconombank, Nutcracker Holdings, HCC Medi...  ...   108.0   \n",
       "7   Village Roadshow Pictures, Polymorphic Picture...  ...    82.0   \n",
       "8   Les films du Worso, Noodles Production, SCOPE ...  ...    81.0   \n",
       "9   Animal Logic, Evergreen Films, Reliance Entert...  ...    87.0   \n",
       "10  Relativity Media, The Weinstein Company, Marc ...  ...   118.0   \n",
       "11  EuropaCorp, Avalanche Productions, Apipoulaï P...  ...    94.0   \n",
       "12  Don Carmody Productions, Impact Pictures, Cons...  ...   105.0   \n",
       "13  Ánima Estudios, Discreet Arts Productions, Viv...  ...    89.0   \n",
       "14  DreamWorks Pictures, Nickelodeon Movies, Cold ...  ...   100.0   \n",
       "15  Paramount Vantage, Likely Story, This is that,...  ...    84.0   \n",
       "16  Paramount Animation, Paramount Pictures, Nicke...  ...    93.0   \n",
       "17  Summertime Entertainment, Prana Animation Studios  ...    88.0   \n",
       "18  Millennium Media, Summit Entertainment, Nu Boy...  ...    99.0   \n",
       "19  Marcy Media, Columbia Pictures, Olive Bridge E...  ...   118.0   \n",
       "\n",
       "               spoken_languages    status  \\\n",
       "0              English, Español  Released   \n",
       "1              Español, English  Released   \n",
       "2                  普通话, English  Released   \n",
       "3                       English  Released   \n",
       "4                       English  Released   \n",
       "5                       English  Released   \n",
       "6                       English  Released   \n",
       "7                       English  Released   \n",
       "8                      Français  Released   \n",
       "9                       English  Released   \n",
       "10  English, Français, Italiano  Released   \n",
       "11                      English  Released   \n",
       "12                      English  Released   \n",
       "13             English, Español  Released   \n",
       "14                      English  Released   \n",
       "15                      English  Released   \n",
       "16                      English  Released   \n",
       "17                      English  Released   \n",
       "18                      English  Released   \n",
       "19                      English  Released   \n",
       "\n",
       "                                              tagline  \\\n",
       "0                         Enter the world of Pandora.   \n",
       "1   Live for danger. Fight for justice. Pray for m...   \n",
       "2                                          Bust a Moo   \n",
       "3                     The truth lies beyond the wall.   \n",
       "4                           Find your breaking point.   \n",
       "5                                    Fast & furry-ous   \n",
       "6   Experience the Holiday Classic as You've Never...   \n",
       "7               Just like real spies... only furrier.   \n",
       "8                                                 NaN   \n",
       "9          The Greatest Adventure in 70 Million Years   \n",
       "10                   This Holiday Season, Be Italian.   \n",
       "11             Adventure awaits in your own backyard.   \n",
       "12                             No warning. No escape.   \n",
       "13                                   The gang is born   \n",
       "14                         No stray gets turned away.   \n",
       "15   The rules are simple. You break them, you die...   \n",
       "16                         Making waves in our world.   \n",
       "17                           There's trouble in OZ...   \n",
       "18                           Every man has a destiny.   \n",
       "19                             It's a hard knock life   \n",
       "\n",
       "                                       title vote_average vote_count  \\\n",
       "0                                     Avatar        7.588      31951   \n",
       "1                              Puss in Boots        6.600       4132   \n",
       "2                          Home on the Range        6.100       2058   \n",
       "3                                  Allegiant        6.100       6661   \n",
       "4                                Point Break        6.000       2307   \n",
       "5     Alvin and the Chipmunks: The Road Chip        6.000       1647   \n",
       "6                             The Nutcracker        5.100        189   \n",
       "7   Cats & Dogs: The Revenge of Kitty Galore        5.200        643   \n",
       "8                                  Evolution        6.000        206   \n",
       "9                     Walking with Dinosaurs        6.200        477   \n",
       "10                                      Nine        5.500        598   \n",
       "11                 Arthur and the Invisibles        6.400       2893   \n",
       "12                                   Pompeii        5.500       3246   \n",
       "13                            Top Cat Begins        6.700        146   \n",
       "14                            Hotel for Dogs        6.037        870   \n",
       "15                                  Carriers        6.059       1400   \n",
       "16  The SpongeBob Movie: Sponge Out of Water        6.100       2374   \n",
       "17           Legends of Oz: Dorothy's Return        6.300        367   \n",
       "18                    The Legend of Hercules        4.800       1331   \n",
       "19                                     Annie        6.200       1283   \n",
       "\n",
       "                                                 cast  \\\n",
       "0   Sam Worthington, Zoe Saldaña, Sigourney Weaver...   \n",
       "1   Antonio Banderas, Salma Hayek Pinault, Zach Ga...   \n",
       "2   Roseanne Barr, Judi Dench, Jennifer Tilly, Ste...   \n",
       "3   Shailene Woodley, Theo James, Miles Teller, Zo...   \n",
       "4   Edgar Ramírez, Luke Bracey, Teresa Palmer, Ray...   \n",
       "5   Jason Lee, Justin Long, Matthew Gray Gubler, J...   \n",
       "6   Elle Fanning, Nathan Lane, John Turturro, Fran...   \n",
       "7   James Marsden, Nick Nolte, Christina Applegate...   \n",
       "8   Max Brebant, Roxane Duran, Julie-Marie Parment...   \n",
       "9   Justin Long, John Leguizamo, Tiya Sircar, Skyl...   \n",
       "10  Daniel Day-Lewis, Marion Cotillard, Penélope C...   \n",
       "11  Freddie Highmore, Madonna, Mia Farrow, Jimmy F...   \n",
       "12  Kit Harington, Emily Browning, Adewale Akinnuo...   \n",
       "13  Jason Harris, David Hoffman, Bill Lobley, Dari...   \n",
       "14  Emma Roberts, Jake T. Austin, Don Cheadle, Joh...   \n",
       "15  Lou Taylor Pucci, Chris Pine, Piper Perabo, Em...   \n",
       "16  Tom Kenny, Bill Fagerbakke, Rodger Bumpass, Cl...   \n",
       "17  Lea Michele, Dan Aykroyd, Jim Belushi, Kelsey ...   \n",
       "18  Kellan Lutz, Liam McIntyre, Gaia Weiss, Scott ...   \n",
       "19  Quvenzhané Wallis, Jamie Foxx, Rose Byrne, Cam...   \n",
       "\n",
       "                                                 crew  \\\n",
       "0   James Cameron, James Cameron, Ilram Choi, Wood...   \n",
       "1   Rich Dietl, Josh Wood, Bob Persichetti, Ken Bi...   \n",
       "2   Carter Goodrich, John Sanford, Will Finn, Alic...   \n",
       "3   Scott Christopher Kelly, Todd Lieberman, Gee A...   \n",
       "4   Ericson Core, Kurt Wimmer, Clay Cullen, Mic Ro...   \n",
       "5   Ross Bagdasarian, Jr., Janice Karman, Ross Bag...   \n",
       "6   Andrei Konchalovsky, Peter Burgis, Andie Derri...   \n",
       "7   Brad Peyton, Ron J. Friedman, Steve Bencich, S...   \n",
       "8   Manuel Dacosse, Lucile Hadžihalilović, Lucile ...   \n",
       "9   Jinko Gotoh, Neil Nightingale, Neil Nightingal...   \n",
       "10  Rob Marshall, Colleen Atwood, Michael Tolkin, ...   \n",
       "11  Luc Besson, Stéphane Lecomte, Luc Besson, Emma...   \n",
       "12  Tracy Shaw, Robert Johnson, Lee Batchler, Paul...   \n",
       "13  Jose C. Garcia de Letona, Leoncio Lara, Patric...   \n",
       "14  Thor Freudenthal, Matt McColm, Jake Rice, Greg...   \n",
       "15  Michael R. Williams, David Pastor, Robert Velo...   \n",
       "16  Pharrell Williams, Chad Hugo, Shay Haley, Paul...   \n",
       "17  Dan St. Pierre, Adam Balsam, Randi Barnes, Rol...   \n",
       "18  Sonu Mishra, Renny Harlin, Trevor Short, Tuoma...   \n",
       "19  Will Gluck, Aline Brosh McKenna, Jay-Z, Will S...   \n",
       "\n",
       "                        director  \n",
       "0                  James Cameron  \n",
       "1                   Chris Miller  \n",
       "2        John Sanford, Will Finn  \n",
       "3               Robert Schwentke  \n",
       "4                   Ericson Core  \n",
       "5                    Walt Becker  \n",
       "6            Andrei Konchalovsky  \n",
       "7                    Brad Peyton  \n",
       "8          Lucile Hadžihalilović  \n",
       "9   Neil Nightingale, Barry Cook  \n",
       "10                  Rob Marshall  \n",
       "11                    Luc Besson  \n",
       "12           Paul W. S. Anderson  \n",
       "13              Andrés Couturier  \n",
       "14              Thor Freudenthal  \n",
       "15     Àlex Pastor, David Pastor  \n",
       "16   Paul Tibbitt, Mike Mitchell  \n",
       "17     Dan St. Pierre, Will Finn  \n",
       "18                  Renny Harlin  \n",
       "19                    Will Gluck  \n",
       "\n",
       "[20 rows x 23 columns]"
      ]
     },
     "execution_count": 84,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tmdb_api_movies.head(20)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "77ffe43f-7750-4f0b-aeb6-0b0fcc17a406",
   "metadata": {
    "jupyter": {
     "source_hidden": true
    }
   },
   "source": [
    "## Import der TMBD Daten - 5.000 Movies data set "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "f77377b6-cdb0-44a2-8c0a-f7eda7dbfa50",
   "metadata": {
    "jupyter": {
     "source_hidden": true
    }
   },
   "outputs": [],
   "source": [
    "# Anpassen der \"JSONähnlichen\" Strukturen\n",
    "\n",
    "def load_tmdb_movies(path):\n",
    "    kaggle_df = pd.read_csv(path)\n",
    "    kaggle_df['release_date'] = pd.to_datetime(kaggle_df['release_date']).apply(lambda x: x.date())\n",
    "    json_columns = ['genres', 'keywords', 'production_countries', 'production_companies', 'spoken_languages']\n",
    "    for column in json_columns:\n",
    "        kaggle_df[column] = kaggle_df[column].apply(json.loads)\n",
    "    return kaggle_df\n",
    "\n",
    "\n",
    "def load_tmdb_credits(path):\n",
    "    kaggle_df = pd.read_csv(path)\n",
    "    json_columns = ['cast', 'crew']\n",
    "    for column in json_columns:\n",
    "        kaggle_df[column] = kaggle_df[column].apply(json.loads)\n",
    "    return kaggle_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "id": "275cebcd-8258-4144-a4c9-c3d255292ed2",
   "metadata": {
    "jupyter": {
     "source_hidden": true
    }
   },
   "outputs": [],
   "source": [
    "kaggle_movies = load_tmdb_movies(\"../input/kaggle_2_tmdb/tmdb_5000_movies.csv\")\n",
    "kaggle_credits = load_tmdb_credits(\"../input/kaggle_2_tmdb/tmdb_5000_credits.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "id": "74da93e1-5d74-49c4-9347-6c26e5fb444a",
   "metadata": {},
   "outputs": [],
   "source": [
    "kaggle_movies = kaggle_movies.rename(columns = { \"id\" : \"movie_id\" })"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "id": "f6b193a5-1516-4915-9d06-be2760108390",
   "metadata": {
    "jupyter": {
     "source_hidden": true
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "budget                                                            3500000\n",
       "genres                  [{'id': 9648, 'name': 'Mystery'}, {'id': 27, '...\n",
       "homepage                                 http://a24films.com/films/witch/\n",
       "movie_id                                                           310131\n",
       "keywords                [{'id': 616, 'name': 'witch'}, {'id': 41393, '...\n",
       "original_language                                                      en\n",
       "original_title                                                  The Witch\n",
       "overview                New England in the 1630s: William and Katherin...\n",
       "popularity                                                      50.319662\n",
       "production_companies    [{'name': 'Parts and Labor', 'id': 6531}, {'na...\n",
       "production_countries    [{'iso_3166_1': 'CA', 'name': 'Canada'}, {'iso...\n",
       "release_date                                                   2016-02-19\n",
       "revenue                                                          40423945\n",
       "runtime                                                              92.0\n",
       "spoken_languages                 [{'iso_639_1': 'en', 'name': 'English'}]\n",
       "status                                                           Released\n",
       "tagline                                            Evil takes many forms.\n",
       "title                                                           The Witch\n",
       "vote_average                                                          6.3\n",
       "vote_count                                                           1434\n",
       "Name: 3835, dtype: object"
      ]
     },
     "execution_count": 74,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "kaggle_movies.iloc[3835]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "id": "135311ad-62e2-4619-9e90-ca48a4494b61",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "movie_id                                               310131\n",
       "title                                               The Witch\n",
       "cast        [{'cast_id': 6, 'character': 'Thomasin', 'cred...\n",
       "crew        [{'credit_id': '5903468bc3a36828df00aee7', 'de...\n",
       "Name: 3835, dtype: object"
      ]
     },
     "execution_count": 75,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "kaggle_credits.iloc[3835]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "faad4bd0-7658-4804-9966-2740f302b08b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['budget', 'genres', 'homepage', 'id', 'keywords', 'original_language',\n",
      "       'original_title', 'overview', 'popularity', 'production_companies',\n",
      "       'production_countries', 'release_date', 'revenue', 'runtime',\n",
      "       'spoken_languages', 'status', 'tagline', 'title', 'vote_average',\n",
      "       'vote_count'],\n",
      "      dtype='object')\n",
      "Index(['movie_id', 'title', 'cast', 'crew'], dtype='object')\n"
     ]
    }
   ],
   "source": [
    "kaggle_movies.sample(10)\n",
    "kaggle_credits.sample(10)\n",
    "\n",
    "print(kaggle_movies.columns)\n",
    "print(kaggle_credits.columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e01819a7-9419-4e42-a785-a0706e202729",
   "metadata": {},
   "outputs": [],
   "source": [
    "#kaggle_moevies[\"genre_no\"] = kaggle_df[\"genres\"].apply( lambda x : [d[\"id\"] for d in x ] )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "id": "02a61484-e8b0-42a3-93b3-0ae36498c931",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>budget</th>\n",
       "      <th>genres</th>\n",
       "      <th>homepage</th>\n",
       "      <th>movie_id</th>\n",
       "      <th>keywords</th>\n",
       "      <th>original_language</th>\n",
       "      <th>original_title</th>\n",
       "      <th>overview</th>\n",
       "      <th>popularity</th>\n",
       "      <th>production_companies</th>\n",
       "      <th>...</th>\n",
       "      <th>runtime</th>\n",
       "      <th>spoken_languages</th>\n",
       "      <th>status</th>\n",
       "      <th>tagline</th>\n",
       "      <th>title_x</th>\n",
       "      <th>vote_average</th>\n",
       "      <th>vote_count</th>\n",
       "      <th>title_y</th>\n",
       "      <th>cast</th>\n",
       "      <th>crew</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>237000000</td>\n",
       "      <td>[{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...</td>\n",
       "      <td>http://www.avatarmovie.com/</td>\n",
       "      <td>19995</td>\n",
       "      <td>[{'id': 1463, 'name': 'culture clash'}, {'id':...</td>\n",
       "      <td>en</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>In the 22nd century, a paraplegic Marine is di...</td>\n",
       "      <td>150.437577</td>\n",
       "      <td>[{'name': 'Ingenious Film Partners', 'id': 289...</td>\n",
       "      <td>...</td>\n",
       "      <td>162.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}, {'iso...</td>\n",
       "      <td>Released</td>\n",
       "      <td>Enter the World of Pandora.</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>7.2</td>\n",
       "      <td>11800</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>[{'cast_id': 242, 'character': 'Jake Sully', '...</td>\n",
       "      <td>[{'credit_id': '52fe48009251416c750aca23', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>300000000</td>\n",
       "      <td>[{'id': 12, 'name': 'Adventure'}, {'id': 14, '...</td>\n",
       "      <td>http://disney.go.com/disneypictures/pirates/</td>\n",
       "      <td>285</td>\n",
       "      <td>[{'id': 270, 'name': 'ocean'}, {'id': 726, 'na...</td>\n",
       "      <td>en</td>\n",
       "      <td>Pirates of the Caribbean: At World's End</td>\n",
       "      <td>Captain Barbossa, long believed to be dead, ha...</td>\n",
       "      <td>139.082615</td>\n",
       "      <td>[{'name': 'Walt Disney Pictures', 'id': 2}, {'...</td>\n",
       "      <td>...</td>\n",
       "      <td>169.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>At the end of the world, the adventure begins.</td>\n",
       "      <td>Pirates of the Caribbean: At World's End</td>\n",
       "      <td>6.9</td>\n",
       "      <td>4500</td>\n",
       "      <td>Pirates of the Caribbean: At World's End</td>\n",
       "      <td>[{'cast_id': 4, 'character': 'Captain Jack Spa...</td>\n",
       "      <td>[{'credit_id': '52fe4232c3a36847f800b579', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>245000000</td>\n",
       "      <td>[{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...</td>\n",
       "      <td>http://www.sonypictures.com/movies/spectre/</td>\n",
       "      <td>206647</td>\n",
       "      <td>[{'id': 470, 'name': 'spy'}, {'id': 818, 'name...</td>\n",
       "      <td>en</td>\n",
       "      <td>Spectre</td>\n",
       "      <td>A cryptic message from Bond’s past sends him o...</td>\n",
       "      <td>107.376788</td>\n",
       "      <td>[{'name': 'Columbia Pictures', 'id': 5}, {'nam...</td>\n",
       "      <td>...</td>\n",
       "      <td>148.0</td>\n",
       "      <td>[{'iso_639_1': 'fr', 'name': 'Français'}, {'is...</td>\n",
       "      <td>Released</td>\n",
       "      <td>A Plan No One Escapes</td>\n",
       "      <td>Spectre</td>\n",
       "      <td>6.3</td>\n",
       "      <td>4466</td>\n",
       "      <td>Spectre</td>\n",
       "      <td>[{'cast_id': 1, 'character': 'James Bond', 'cr...</td>\n",
       "      <td>[{'credit_id': '54805967c3a36829b5002c41', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>250000000</td>\n",
       "      <td>[{'id': 28, 'name': 'Action'}, {'id': 80, 'nam...</td>\n",
       "      <td>http://www.thedarkknightrises.com/</td>\n",
       "      <td>49026</td>\n",
       "      <td>[{'id': 849, 'name': 'dc comics'}, {'id': 853,...</td>\n",
       "      <td>en</td>\n",
       "      <td>The Dark Knight Rises</td>\n",
       "      <td>Following the death of District Attorney Harve...</td>\n",
       "      <td>112.312950</td>\n",
       "      <td>[{'name': 'Legendary Pictures', 'id': 923}, {'...</td>\n",
       "      <td>...</td>\n",
       "      <td>165.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>The Legend Ends</td>\n",
       "      <td>The Dark Knight Rises</td>\n",
       "      <td>7.6</td>\n",
       "      <td>9106</td>\n",
       "      <td>The Dark Knight Rises</td>\n",
       "      <td>[{'cast_id': 2, 'character': 'Bruce Wayne / Ba...</td>\n",
       "      <td>[{'credit_id': '52fe4781c3a36847f81398c3', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>260000000</td>\n",
       "      <td>[{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...</td>\n",
       "      <td>http://movies.disney.com/john-carter</td>\n",
       "      <td>49529</td>\n",
       "      <td>[{'id': 818, 'name': 'based on novel'}, {'id':...</td>\n",
       "      <td>en</td>\n",
       "      <td>John Carter</td>\n",
       "      <td>John Carter is a war-weary, former military ca...</td>\n",
       "      <td>43.926995</td>\n",
       "      <td>[{'name': 'Walt Disney Pictures', 'id': 2}]</td>\n",
       "      <td>...</td>\n",
       "      <td>132.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>Lost in our world, found in another.</td>\n",
       "      <td>John Carter</td>\n",
       "      <td>6.1</td>\n",
       "      <td>2124</td>\n",
       "      <td>John Carter</td>\n",
       "      <td>[{'cast_id': 5, 'character': 'John Carter', 'c...</td>\n",
       "      <td>[{'credit_id': '52fe479ac3a36847f813eaa3', 'de...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      budget                                             genres  \\\n",
       "0  237000000  [{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...   \n",
       "1  300000000  [{'id': 12, 'name': 'Adventure'}, {'id': 14, '...   \n",
       "2  245000000  [{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...   \n",
       "3  250000000  [{'id': 28, 'name': 'Action'}, {'id': 80, 'nam...   \n",
       "4  260000000  [{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...   \n",
       "\n",
       "                                       homepage  movie_id  \\\n",
       "0                   http://www.avatarmovie.com/     19995   \n",
       "1  http://disney.go.com/disneypictures/pirates/       285   \n",
       "2   http://www.sonypictures.com/movies/spectre/    206647   \n",
       "3            http://www.thedarkknightrises.com/     49026   \n",
       "4          http://movies.disney.com/john-carter     49529   \n",
       "\n",
       "                                            keywords original_language  \\\n",
       "0  [{'id': 1463, 'name': 'culture clash'}, {'id':...                en   \n",
       "1  [{'id': 270, 'name': 'ocean'}, {'id': 726, 'na...                en   \n",
       "2  [{'id': 470, 'name': 'spy'}, {'id': 818, 'name...                en   \n",
       "3  [{'id': 849, 'name': 'dc comics'}, {'id': 853,...                en   \n",
       "4  [{'id': 818, 'name': 'based on novel'}, {'id':...                en   \n",
       "\n",
       "                             original_title  \\\n",
       "0                                    Avatar   \n",
       "1  Pirates of the Caribbean: At World's End   \n",
       "2                                   Spectre   \n",
       "3                     The Dark Knight Rises   \n",
       "4                               John Carter   \n",
       "\n",
       "                                            overview  popularity  \\\n",
       "0  In the 22nd century, a paraplegic Marine is di...  150.437577   \n",
       "1  Captain Barbossa, long believed to be dead, ha...  139.082615   \n",
       "2  A cryptic message from Bond’s past sends him o...  107.376788   \n",
       "3  Following the death of District Attorney Harve...  112.312950   \n",
       "4  John Carter is a war-weary, former military ca...   43.926995   \n",
       "\n",
       "                                production_companies  ... runtime  \\\n",
       "0  [{'name': 'Ingenious Film Partners', 'id': 289...  ...   162.0   \n",
       "1  [{'name': 'Walt Disney Pictures', 'id': 2}, {'...  ...   169.0   \n",
       "2  [{'name': 'Columbia Pictures', 'id': 5}, {'nam...  ...   148.0   \n",
       "3  [{'name': 'Legendary Pictures', 'id': 923}, {'...  ...   165.0   \n",
       "4        [{'name': 'Walt Disney Pictures', 'id': 2}]  ...   132.0   \n",
       "\n",
       "                                    spoken_languages    status  \\\n",
       "0  [{'iso_639_1': 'en', 'name': 'English'}, {'iso...  Released   \n",
       "1           [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "2  [{'iso_639_1': 'fr', 'name': 'Français'}, {'is...  Released   \n",
       "3           [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "4           [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "\n",
       "                                          tagline  \\\n",
       "0                     Enter the World of Pandora.   \n",
       "1  At the end of the world, the adventure begins.   \n",
       "2                           A Plan No One Escapes   \n",
       "3                                 The Legend Ends   \n",
       "4            Lost in our world, found in another.   \n",
       "\n",
       "                                    title_x vote_average vote_count  \\\n",
       "0                                    Avatar          7.2      11800   \n",
       "1  Pirates of the Caribbean: At World's End          6.9       4500   \n",
       "2                                   Spectre          6.3       4466   \n",
       "3                     The Dark Knight Rises          7.6       9106   \n",
       "4                               John Carter          6.1       2124   \n",
       "\n",
       "                                    title_y  \\\n",
       "0                                    Avatar   \n",
       "1  Pirates of the Caribbean: At World's End   \n",
       "2                                   Spectre   \n",
       "3                     The Dark Knight Rises   \n",
       "4                               John Carter   \n",
       "\n",
       "                                                cast  \\\n",
       "0  [{'cast_id': 242, 'character': 'Jake Sully', '...   \n",
       "1  [{'cast_id': 4, 'character': 'Captain Jack Spa...   \n",
       "2  [{'cast_id': 1, 'character': 'James Bond', 'cr...   \n",
       "3  [{'cast_id': 2, 'character': 'Bruce Wayne / Ba...   \n",
       "4  [{'cast_id': 5, 'character': 'John Carter', 'c...   \n",
       "\n",
       "                                                crew  \n",
       "0  [{'credit_id': '52fe48009251416c750aca23', 'de...  \n",
       "1  [{'credit_id': '52fe4232c3a36847f800b579', 'de...  \n",
       "2  [{'credit_id': '54805967c3a36829b5002c41', 'de...  \n",
       "3  [{'credit_id': '52fe4781c3a36847f81398c3', 'de...  \n",
       "4  [{'credit_id': '52fe479ac3a36847f813eaa3', 'de...  \n",
       "\n",
       "[5 rows x 23 columns]"
      ]
     },
     "execution_count": 90,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "kaggle_movs = kaggle_movies.merge(kaggle_credits, on = \"movie_id\")\n",
    "kaggle_movs.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "id": "bdd8e4c7-a58d-4fab-8ff4-cdfae6797a43",
   "metadata": {},
   "outputs": [],
   "source": [
    "kaggle_movs = kaggle_movs.drop(\"title_y\", axis=1)\n",
    "kaggle_movs = kaggle_movs.rename(columns={ \"title_x\" : \"title\" })"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "id": "bcf51b08-48ca-4785-b31c-760a39d91b53",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>budget</th>\n",
       "      <th>genres</th>\n",
       "      <th>homepage</th>\n",
       "      <th>movie_id</th>\n",
       "      <th>keywords</th>\n",
       "      <th>original_language</th>\n",
       "      <th>original_title</th>\n",
       "      <th>overview</th>\n",
       "      <th>popularity</th>\n",
       "      <th>production_companies</th>\n",
       "      <th>...</th>\n",
       "      <th>runtime</th>\n",
       "      <th>spoken_languages</th>\n",
       "      <th>status</th>\n",
       "      <th>tagline</th>\n",
       "      <th>title_x</th>\n",
       "      <th>vote_average</th>\n",
       "      <th>vote_count</th>\n",
       "      <th>title_y</th>\n",
       "      <th>cast</th>\n",
       "      <th>crew</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>237000000</td>\n",
       "      <td>[{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...</td>\n",
       "      <td>http://www.avatarmovie.com/</td>\n",
       "      <td>19995</td>\n",
       "      <td>[{'id': 1463, 'name': 'culture clash'}, {'id':...</td>\n",
       "      <td>en</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>In the 22nd century, a paraplegic Marine is di...</td>\n",
       "      <td>150.437577</td>\n",
       "      <td>[{'name': 'Ingenious Film Partners', 'id': 289...</td>\n",
       "      <td>...</td>\n",
       "      <td>162.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}, {'iso...</td>\n",
       "      <td>Released</td>\n",
       "      <td>Enter the World of Pandora.</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>7.2</td>\n",
       "      <td>11800</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>[{'cast_id': 242, 'character': 'Jake Sully', '...</td>\n",
       "      <td>[{'credit_id': '52fe48009251416c750aca23', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>300000000</td>\n",
       "      <td>[{'id': 12, 'name': 'Adventure'}, {'id': 14, '...</td>\n",
       "      <td>http://disney.go.com/disneypictures/pirates/</td>\n",
       "      <td>285</td>\n",
       "      <td>[{'id': 270, 'name': 'ocean'}, {'id': 726, 'na...</td>\n",
       "      <td>en</td>\n",
       "      <td>Pirates of the Caribbean: At World's End</td>\n",
       "      <td>Captain Barbossa, long believed to be dead, ha...</td>\n",
       "      <td>139.082615</td>\n",
       "      <td>[{'name': 'Walt Disney Pictures', 'id': 2}, {'...</td>\n",
       "      <td>...</td>\n",
       "      <td>169.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>At the end of the world, the adventure begins.</td>\n",
       "      <td>Pirates of the Caribbean: At World's End</td>\n",
       "      <td>6.9</td>\n",
       "      <td>4500</td>\n",
       "      <td>Pirates of the Caribbean: At World's End</td>\n",
       "      <td>[{'cast_id': 4, 'character': 'Captain Jack Spa...</td>\n",
       "      <td>[{'credit_id': '52fe4232c3a36847f800b579', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>245000000</td>\n",
       "      <td>[{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...</td>\n",
       "      <td>http://www.sonypictures.com/movies/spectre/</td>\n",
       "      <td>206647</td>\n",
       "      <td>[{'id': 470, 'name': 'spy'}, {'id': 818, 'name...</td>\n",
       "      <td>en</td>\n",
       "      <td>Spectre</td>\n",
       "      <td>A cryptic message from Bond’s past sends him o...</td>\n",
       "      <td>107.376788</td>\n",
       "      <td>[{'name': 'Columbia Pictures', 'id': 5}, {'nam...</td>\n",
       "      <td>...</td>\n",
       "      <td>148.0</td>\n",
       "      <td>[{'iso_639_1': 'fr', 'name': 'Français'}, {'is...</td>\n",
       "      <td>Released</td>\n",
       "      <td>A Plan No One Escapes</td>\n",
       "      <td>Spectre</td>\n",
       "      <td>6.3</td>\n",
       "      <td>4466</td>\n",
       "      <td>Spectre</td>\n",
       "      <td>[{'cast_id': 1, 'character': 'James Bond', 'cr...</td>\n",
       "      <td>[{'credit_id': '54805967c3a36829b5002c41', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>250000000</td>\n",
       "      <td>[{'id': 28, 'name': 'Action'}, {'id': 80, 'nam...</td>\n",
       "      <td>http://www.thedarkknightrises.com/</td>\n",
       "      <td>49026</td>\n",
       "      <td>[{'id': 849, 'name': 'dc comics'}, {'id': 853,...</td>\n",
       "      <td>en</td>\n",
       "      <td>The Dark Knight Rises</td>\n",
       "      <td>Following the death of District Attorney Harve...</td>\n",
       "      <td>112.312950</td>\n",
       "      <td>[{'name': 'Legendary Pictures', 'id': 923}, {'...</td>\n",
       "      <td>...</td>\n",
       "      <td>165.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>The Legend Ends</td>\n",
       "      <td>The Dark Knight Rises</td>\n",
       "      <td>7.6</td>\n",
       "      <td>9106</td>\n",
       "      <td>The Dark Knight Rises</td>\n",
       "      <td>[{'cast_id': 2, 'character': 'Bruce Wayne / Ba...</td>\n",
       "      <td>[{'credit_id': '52fe4781c3a36847f81398c3', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>260000000</td>\n",
       "      <td>[{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...</td>\n",
       "      <td>http://movies.disney.com/john-carter</td>\n",
       "      <td>49529</td>\n",
       "      <td>[{'id': 818, 'name': 'based on novel'}, {'id':...</td>\n",
       "      <td>en</td>\n",
       "      <td>John Carter</td>\n",
       "      <td>John Carter is a war-weary, former military ca...</td>\n",
       "      <td>43.926995</td>\n",
       "      <td>[{'name': 'Walt Disney Pictures', 'id': 2}]</td>\n",
       "      <td>...</td>\n",
       "      <td>132.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>Lost in our world, found in another.</td>\n",
       "      <td>John Carter</td>\n",
       "      <td>6.1</td>\n",
       "      <td>2124</td>\n",
       "      <td>John Carter</td>\n",
       "      <td>[{'cast_id': 5, 'character': 'John Carter', 'c...</td>\n",
       "      <td>[{'credit_id': '52fe479ac3a36847f813eaa3', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4798</th>\n",
       "      <td>220000</td>\n",
       "      <td>[{'id': 28, 'name': 'Action'}, {'id': 80, 'nam...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9367</td>\n",
       "      <td>[{'id': 5616, 'name': 'united states–mexico ba...</td>\n",
       "      <td>es</td>\n",
       "      <td>El Mariachi</td>\n",
       "      <td>El Mariachi just wants to play his guitar and ...</td>\n",
       "      <td>14.269792</td>\n",
       "      <td>[{'name': 'Columbia Pictures', 'id': 5}]</td>\n",
       "      <td>...</td>\n",
       "      <td>81.0</td>\n",
       "      <td>[{'iso_639_1': 'es', 'name': 'Español'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>He didn't come looking for trouble, but troubl...</td>\n",
       "      <td>El Mariachi</td>\n",
       "      <td>6.6</td>\n",
       "      <td>238</td>\n",
       "      <td>El Mariachi</td>\n",
       "      <td>[{'cast_id': 1, 'character': 'El Mariachi', 'c...</td>\n",
       "      <td>[{'credit_id': '52fe44eec3a36847f80b280b', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4799</th>\n",
       "      <td>9000</td>\n",
       "      <td>[{'id': 35, 'name': 'Comedy'}, {'id': 10749, '...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>72766</td>\n",
       "      <td>[]</td>\n",
       "      <td>en</td>\n",
       "      <td>Newlyweds</td>\n",
       "      <td>A newlywed couple's honeymoon is upended by th...</td>\n",
       "      <td>0.642552</td>\n",
       "      <td>[]</td>\n",
       "      <td>...</td>\n",
       "      <td>85.0</td>\n",
       "      <td>[]</td>\n",
       "      <td>Released</td>\n",
       "      <td>A newlywed couple's honeymoon is upended by th...</td>\n",
       "      <td>Newlyweds</td>\n",
       "      <td>5.9</td>\n",
       "      <td>5</td>\n",
       "      <td>Newlyweds</td>\n",
       "      <td>[{'cast_id': 1, 'character': 'Buzzy', 'credit_...</td>\n",
       "      <td>[{'credit_id': '52fe487dc3a368484e0fb013', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4800</th>\n",
       "      <td>0</td>\n",
       "      <td>[{'id': 35, 'name': 'Comedy'}, {'id': 18, 'nam...</td>\n",
       "      <td>http://www.hallmarkchannel.com/signedsealeddel...</td>\n",
       "      <td>231617</td>\n",
       "      <td>[{'id': 248, 'name': 'date'}, {'id': 699, 'nam...</td>\n",
       "      <td>en</td>\n",
       "      <td>Signed, Sealed, Delivered</td>\n",
       "      <td>\"Signed, Sealed, Delivered\" introduces a dedic...</td>\n",
       "      <td>1.444476</td>\n",
       "      <td>[{'name': 'Front Street Pictures', 'id': 3958}...</td>\n",
       "      <td>...</td>\n",
       "      <td>120.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Signed, Sealed, Delivered</td>\n",
       "      <td>7.0</td>\n",
       "      <td>6</td>\n",
       "      <td>Signed, Sealed, Delivered</td>\n",
       "      <td>[{'cast_id': 8, 'character': 'Oliver O’Toole',...</td>\n",
       "      <td>[{'credit_id': '52fe4df3c3a36847f8275ecf', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4801</th>\n",
       "      <td>0</td>\n",
       "      <td>[]</td>\n",
       "      <td>http://shanghaicalling.com/</td>\n",
       "      <td>126186</td>\n",
       "      <td>[]</td>\n",
       "      <td>en</td>\n",
       "      <td>Shanghai Calling</td>\n",
       "      <td>When ambitious New York attorney Sam is sent t...</td>\n",
       "      <td>0.857008</td>\n",
       "      <td>[]</td>\n",
       "      <td>...</td>\n",
       "      <td>98.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>A New Yorker in Shanghai</td>\n",
       "      <td>Shanghai Calling</td>\n",
       "      <td>5.7</td>\n",
       "      <td>7</td>\n",
       "      <td>Shanghai Calling</td>\n",
       "      <td>[{'cast_id': 3, 'character': 'Sam', 'credit_id...</td>\n",
       "      <td>[{'credit_id': '52fe4ad9c3a368484e16a36b', 'de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4802</th>\n",
       "      <td>0</td>\n",
       "      <td>[{'id': 99, 'name': 'Documentary'}]</td>\n",
       "      <td>NaN</td>\n",
       "      <td>25975</td>\n",
       "      <td>[{'id': 1523, 'name': 'obsession'}, {'id': 224...</td>\n",
       "      <td>en</td>\n",
       "      <td>My Date with Drew</td>\n",
       "      <td>Ever since the second grade when he first saw ...</td>\n",
       "      <td>1.929883</td>\n",
       "      <td>[{'name': 'rusty bear entertainment', 'id': 87...</td>\n",
       "      <td>...</td>\n",
       "      <td>90.0</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>NaN</td>\n",
       "      <td>My Date with Drew</td>\n",
       "      <td>6.3</td>\n",
       "      <td>16</td>\n",
       "      <td>My Date with Drew</td>\n",
       "      <td>[{'cast_id': 3, 'character': 'Herself', 'credi...</td>\n",
       "      <td>[{'credit_id': '58ce021b9251415a390165d9', 'de...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4803 rows × 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         budget                                             genres  \\\n",
       "0     237000000  [{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...   \n",
       "1     300000000  [{'id': 12, 'name': 'Adventure'}, {'id': 14, '...   \n",
       "2     245000000  [{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...   \n",
       "3     250000000  [{'id': 28, 'name': 'Action'}, {'id': 80, 'nam...   \n",
       "4     260000000  [{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...   \n",
       "...         ...                                                ...   \n",
       "4798     220000  [{'id': 28, 'name': 'Action'}, {'id': 80, 'nam...   \n",
       "4799       9000  [{'id': 35, 'name': 'Comedy'}, {'id': 10749, '...   \n",
       "4800          0  [{'id': 35, 'name': 'Comedy'}, {'id': 18, 'nam...   \n",
       "4801          0                                                 []   \n",
       "4802          0                [{'id': 99, 'name': 'Documentary'}]   \n",
       "\n",
       "                                               homepage  movie_id  \\\n",
       "0                           http://www.avatarmovie.com/     19995   \n",
       "1          http://disney.go.com/disneypictures/pirates/       285   \n",
       "2           http://www.sonypictures.com/movies/spectre/    206647   \n",
       "3                    http://www.thedarkknightrises.com/     49026   \n",
       "4                  http://movies.disney.com/john-carter     49529   \n",
       "...                                                 ...       ...   \n",
       "4798                                                NaN      9367   \n",
       "4799                                                NaN     72766   \n",
       "4800  http://www.hallmarkchannel.com/signedsealeddel...    231617   \n",
       "4801                        http://shanghaicalling.com/    126186   \n",
       "4802                                                NaN     25975   \n",
       "\n",
       "                                               keywords original_language  \\\n",
       "0     [{'id': 1463, 'name': 'culture clash'}, {'id':...                en   \n",
       "1     [{'id': 270, 'name': 'ocean'}, {'id': 726, 'na...                en   \n",
       "2     [{'id': 470, 'name': 'spy'}, {'id': 818, 'name...                en   \n",
       "3     [{'id': 849, 'name': 'dc comics'}, {'id': 853,...                en   \n",
       "4     [{'id': 818, 'name': 'based on novel'}, {'id':...                en   \n",
       "...                                                 ...               ...   \n",
       "4798  [{'id': 5616, 'name': 'united states–mexico ba...                es   \n",
       "4799                                                 []                en   \n",
       "4800  [{'id': 248, 'name': 'date'}, {'id': 699, 'nam...                en   \n",
       "4801                                                 []                en   \n",
       "4802  [{'id': 1523, 'name': 'obsession'}, {'id': 224...                en   \n",
       "\n",
       "                                original_title  \\\n",
       "0                                       Avatar   \n",
       "1     Pirates of the Caribbean: At World's End   \n",
       "2                                      Spectre   \n",
       "3                        The Dark Knight Rises   \n",
       "4                                  John Carter   \n",
       "...                                        ...   \n",
       "4798                               El Mariachi   \n",
       "4799                                 Newlyweds   \n",
       "4800                 Signed, Sealed, Delivered   \n",
       "4801                          Shanghai Calling   \n",
       "4802                         My Date with Drew   \n",
       "\n",
       "                                               overview  popularity  \\\n",
       "0     In the 22nd century, a paraplegic Marine is di...  150.437577   \n",
       "1     Captain Barbossa, long believed to be dead, ha...  139.082615   \n",
       "2     A cryptic message from Bond’s past sends him o...  107.376788   \n",
       "3     Following the death of District Attorney Harve...  112.312950   \n",
       "4     John Carter is a war-weary, former military ca...   43.926995   \n",
       "...                                                 ...         ...   \n",
       "4798  El Mariachi just wants to play his guitar and ...   14.269792   \n",
       "4799  A newlywed couple's honeymoon is upended by th...    0.642552   \n",
       "4800  \"Signed, Sealed, Delivered\" introduces a dedic...    1.444476   \n",
       "4801  When ambitious New York attorney Sam is sent t...    0.857008   \n",
       "4802  Ever since the second grade when he first saw ...    1.929883   \n",
       "\n",
       "                                   production_companies  ... runtime  \\\n",
       "0     [{'name': 'Ingenious Film Partners', 'id': 289...  ...   162.0   \n",
       "1     [{'name': 'Walt Disney Pictures', 'id': 2}, {'...  ...   169.0   \n",
       "2     [{'name': 'Columbia Pictures', 'id': 5}, {'nam...  ...   148.0   \n",
       "3     [{'name': 'Legendary Pictures', 'id': 923}, {'...  ...   165.0   \n",
       "4           [{'name': 'Walt Disney Pictures', 'id': 2}]  ...   132.0   \n",
       "...                                                 ...  ...     ...   \n",
       "4798           [{'name': 'Columbia Pictures', 'id': 5}]  ...    81.0   \n",
       "4799                                                 []  ...    85.0   \n",
       "4800  [{'name': 'Front Street Pictures', 'id': 3958}...  ...   120.0   \n",
       "4801                                                 []  ...    98.0   \n",
       "4802  [{'name': 'rusty bear entertainment', 'id': 87...  ...    90.0   \n",
       "\n",
       "                                       spoken_languages    status  \\\n",
       "0     [{'iso_639_1': 'en', 'name': 'English'}, {'iso...  Released   \n",
       "1              [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "2     [{'iso_639_1': 'fr', 'name': 'Français'}, {'is...  Released   \n",
       "3              [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "4              [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "...                                                 ...       ...   \n",
       "4798           [{'iso_639_1': 'es', 'name': 'Español'}]  Released   \n",
       "4799                                                 []  Released   \n",
       "4800           [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "4801           [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "4802           [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "\n",
       "                                                tagline  \\\n",
       "0                           Enter the World of Pandora.   \n",
       "1        At the end of the world, the adventure begins.   \n",
       "2                                 A Plan No One Escapes   \n",
       "3                                       The Legend Ends   \n",
       "4                  Lost in our world, found in another.   \n",
       "...                                                 ...   \n",
       "4798  He didn't come looking for trouble, but troubl...   \n",
       "4799  A newlywed couple's honeymoon is upended by th...   \n",
       "4800                                                NaN   \n",
       "4801                           A New Yorker in Shanghai   \n",
       "4802                                                NaN   \n",
       "\n",
       "                                       title_x vote_average vote_count  \\\n",
       "0                                       Avatar          7.2      11800   \n",
       "1     Pirates of the Caribbean: At World's End          6.9       4500   \n",
       "2                                      Spectre          6.3       4466   \n",
       "3                        The Dark Knight Rises          7.6       9106   \n",
       "4                                  John Carter          6.1       2124   \n",
       "...                                        ...          ...        ...   \n",
       "4798                               El Mariachi          6.6        238   \n",
       "4799                                 Newlyweds          5.9          5   \n",
       "4800                 Signed, Sealed, Delivered          7.0          6   \n",
       "4801                          Shanghai Calling          5.7          7   \n",
       "4802                         My Date with Drew          6.3         16   \n",
       "\n",
       "                                       title_y  \\\n",
       "0                                       Avatar   \n",
       "1     Pirates of the Caribbean: At World's End   \n",
       "2                                      Spectre   \n",
       "3                        The Dark Knight Rises   \n",
       "4                                  John Carter   \n",
       "...                                        ...   \n",
       "4798                               El Mariachi   \n",
       "4799                                 Newlyweds   \n",
       "4800                 Signed, Sealed, Delivered   \n",
       "4801                          Shanghai Calling   \n",
       "4802                         My Date with Drew   \n",
       "\n",
       "                                                   cast  \\\n",
       "0     [{'cast_id': 242, 'character': 'Jake Sully', '...   \n",
       "1     [{'cast_id': 4, 'character': 'Captain Jack Spa...   \n",
       "2     [{'cast_id': 1, 'character': 'James Bond', 'cr...   \n",
       "3     [{'cast_id': 2, 'character': 'Bruce Wayne / Ba...   \n",
       "4     [{'cast_id': 5, 'character': 'John Carter', 'c...   \n",
       "...                                                 ...   \n",
       "4798  [{'cast_id': 1, 'character': 'El Mariachi', 'c...   \n",
       "4799  [{'cast_id': 1, 'character': 'Buzzy', 'credit_...   \n",
       "4800  [{'cast_id': 8, 'character': 'Oliver O’Toole',...   \n",
       "4801  [{'cast_id': 3, 'character': 'Sam', 'credit_id...   \n",
       "4802  [{'cast_id': 3, 'character': 'Herself', 'credi...   \n",
       "\n",
       "                                                   crew  \n",
       "0     [{'credit_id': '52fe48009251416c750aca23', 'de...  \n",
       "1     [{'credit_id': '52fe4232c3a36847f800b579', 'de...  \n",
       "2     [{'credit_id': '54805967c3a36829b5002c41', 'de...  \n",
       "3     [{'credit_id': '52fe4781c3a36847f81398c3', 'de...  \n",
       "4     [{'credit_id': '52fe479ac3a36847f813eaa3', 'de...  \n",
       "...                                                 ...  \n",
       "4798  [{'credit_id': '52fe44eec3a36847f80b280b', 'de...  \n",
       "4799  [{'credit_id': '52fe487dc3a368484e0fb013', 'de...  \n",
       "4800  [{'credit_id': '52fe4df3c3a36847f8275ecf', 'de...  \n",
       "4801  [{'credit_id': '52fe4ad9c3a368484e16a36b', 'de...  \n",
       "4802  [{'credit_id': '58ce021b9251415a390165d9', 'de...  \n",
       "\n",
       "[4803 rows x 23 columns]"
      ]
     },
     "execution_count": 86,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "kaggle_movs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "6cd94cd2-b20b-4282-9669-ff8b7bcfa3f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Get the director's name from the crew feature. If director is not listed, return NaN\n",
    "def get_director(x):\n",
    "    for i in x:\n",
    "        if i['job'] == 'Director':\n",
    "            return i['name']\n",
    "    return np.nan"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "1f32487c-83c9-4cb2-a00a-aba630d09aa1",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Returns the list top 3 elements or entire list; whichever is more.\n",
    "def get_list_old(x):\n",
    "    if isinstance(x, list):\n",
    "        names = [i['name'] for i in x]\n",
    "        #Check if more than 3 elements exist. If yes, return only first three. If no, return entire list.\n",
    "        if len(names) > 5:\n",
    "            names = names[:5]\n",
    "        return names\n",
    "\n",
    "    #Return empty list in case of missing/malformed data\n",
    "    return []"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "7829901c-ae10-45b1-b7f4-123129dc9e52",
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_list(x):\n",
    "    if isinstance(x, list):\n",
    "        names = [i['name'] for i in x]  # Extrahiert die 'name'-Werte aus der Liste von Dictionaries\n",
    "        if len(names) > 5:\n",
    "            names = names[:5]  # Falls mehr als 5 Einträge, nur die ersten 5 behalten\n",
    "        return \", \".join(names)  # Kommagetrennten String zurückgeben\n",
    "\n",
    "    return \"\"  # Falls kein gültiger Wert, leeren String zurückgeben\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "id": "d2abe0e8-70ed-4609-9f18-54c40d0443e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Define new director, cast, genres and keywords features that are in a suitable form.\n",
    "kaggle_movs['director'] = kaggle_movs['crew'].apply(get_director)\n",
    "\n",
    "features = ['cast', 'keywords', 'genres']\n",
    "for feature in features:\n",
    "    kaggle_movs[feature] = kaggle_movs[feature].apply(get_list)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "id": "de8ccf58-b4f0-4c39-8278-5b0016ad9a87",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>budget</th>\n",
       "      <th>genres</th>\n",
       "      <th>homepage</th>\n",
       "      <th>movie_id</th>\n",
       "      <th>keywords</th>\n",
       "      <th>original_language</th>\n",
       "      <th>original_title</th>\n",
       "      <th>overview</th>\n",
       "      <th>popularity</th>\n",
       "      <th>production_companies</th>\n",
       "      <th>...</th>\n",
       "      <th>spoken_languages</th>\n",
       "      <th>status</th>\n",
       "      <th>tagline</th>\n",
       "      <th>title_x</th>\n",
       "      <th>vote_average</th>\n",
       "      <th>vote_count</th>\n",
       "      <th>title_y</th>\n",
       "      <th>cast</th>\n",
       "      <th>crew</th>\n",
       "      <th>director</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>237000000</td>\n",
       "      <td>Action, Adventure, Fantasy, Science Fiction</td>\n",
       "      <td>http://www.avatarmovie.com/</td>\n",
       "      <td>19995</td>\n",
       "      <td>culture clash, future, space war, space colony...</td>\n",
       "      <td>en</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>In the 22nd century, a paraplegic Marine is di...</td>\n",
       "      <td>150.437577</td>\n",
       "      <td>[{'name': 'Ingenious Film Partners', 'id': 289...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}, {'iso...</td>\n",
       "      <td>Released</td>\n",
       "      <td>Enter the World of Pandora.</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>7.2</td>\n",
       "      <td>11800</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>Sam Worthington, Zoe Saldana, Sigourney Weaver...</td>\n",
       "      <td>[{'credit_id': '52fe48009251416c750aca23', 'de...</td>\n",
       "      <td>James Cameron</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>300000000</td>\n",
       "      <td>Adventure, Fantasy, Action</td>\n",
       "      <td>http://disney.go.com/disneypictures/pirates/</td>\n",
       "      <td>285</td>\n",
       "      <td>ocean, drug abuse, exotic island, east india t...</td>\n",
       "      <td>en</td>\n",
       "      <td>Pirates of the Caribbean: At World's End</td>\n",
       "      <td>Captain Barbossa, long believed to be dead, ha...</td>\n",
       "      <td>139.082615</td>\n",
       "      <td>[{'name': 'Walt Disney Pictures', 'id': 2}, {'...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>At the end of the world, the adventure begins.</td>\n",
       "      <td>Pirates of the Caribbean: At World's End</td>\n",
       "      <td>6.9</td>\n",
       "      <td>4500</td>\n",
       "      <td>Pirates of the Caribbean: At World's End</td>\n",
       "      <td>Johnny Depp, Orlando Bloom, Keira Knightley, S...</td>\n",
       "      <td>[{'credit_id': '52fe4232c3a36847f800b579', 'de...</td>\n",
       "      <td>Gore Verbinski</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>245000000</td>\n",
       "      <td>Action, Adventure, Crime</td>\n",
       "      <td>http://www.sonypictures.com/movies/spectre/</td>\n",
       "      <td>206647</td>\n",
       "      <td>spy, based on novel, secret agent, sequel, mi6</td>\n",
       "      <td>en</td>\n",
       "      <td>Spectre</td>\n",
       "      <td>A cryptic message from Bond’s past sends him o...</td>\n",
       "      <td>107.376788</td>\n",
       "      <td>[{'name': 'Columbia Pictures', 'id': 5}, {'nam...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'iso_639_1': 'fr', 'name': 'Français'}, {'is...</td>\n",
       "      <td>Released</td>\n",
       "      <td>A Plan No One Escapes</td>\n",
       "      <td>Spectre</td>\n",
       "      <td>6.3</td>\n",
       "      <td>4466</td>\n",
       "      <td>Spectre</td>\n",
       "      <td>Daniel Craig, Christoph Waltz, Léa Seydoux, Ra...</td>\n",
       "      <td>[{'credit_id': '54805967c3a36829b5002c41', 'de...</td>\n",
       "      <td>Sam Mendes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>250000000</td>\n",
       "      <td>Action, Crime, Drama, Thriller</td>\n",
       "      <td>http://www.thedarkknightrises.com/</td>\n",
       "      <td>49026</td>\n",
       "      <td>dc comics, crime fighter, terrorist, secret id...</td>\n",
       "      <td>en</td>\n",
       "      <td>The Dark Knight Rises</td>\n",
       "      <td>Following the death of District Attorney Harve...</td>\n",
       "      <td>112.312950</td>\n",
       "      <td>[{'name': 'Legendary Pictures', 'id': 923}, {'...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>The Legend Ends</td>\n",
       "      <td>The Dark Knight Rises</td>\n",
       "      <td>7.6</td>\n",
       "      <td>9106</td>\n",
       "      <td>The Dark Knight Rises</td>\n",
       "      <td>Christian Bale, Michael Caine, Gary Oldman, An...</td>\n",
       "      <td>[{'credit_id': '52fe4781c3a36847f81398c3', 'de...</td>\n",
       "      <td>Christopher Nolan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>260000000</td>\n",
       "      <td>Action, Adventure, Science Fiction</td>\n",
       "      <td>http://movies.disney.com/john-carter</td>\n",
       "      <td>49529</td>\n",
       "      <td>based on novel, mars, medallion, space travel,...</td>\n",
       "      <td>en</td>\n",
       "      <td>John Carter</td>\n",
       "      <td>John Carter is a war-weary, former military ca...</td>\n",
       "      <td>43.926995</td>\n",
       "      <td>[{'name': 'Walt Disney Pictures', 'id': 2}]</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>Lost in our world, found in another.</td>\n",
       "      <td>John Carter</td>\n",
       "      <td>6.1</td>\n",
       "      <td>2124</td>\n",
       "      <td>John Carter</td>\n",
       "      <td>Taylor Kitsch, Lynn Collins, Samantha Morton, ...</td>\n",
       "      <td>[{'credit_id': '52fe479ac3a36847f813eaa3', 'de...</td>\n",
       "      <td>Andrew Stanton</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4798</th>\n",
       "      <td>220000</td>\n",
       "      <td>Action, Crime, Thriller</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9367</td>\n",
       "      <td>united states–mexico barrier, legs, arms, pape...</td>\n",
       "      <td>es</td>\n",
       "      <td>El Mariachi</td>\n",
       "      <td>El Mariachi just wants to play his guitar and ...</td>\n",
       "      <td>14.269792</td>\n",
       "      <td>[{'name': 'Columbia Pictures', 'id': 5}]</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'iso_639_1': 'es', 'name': 'Español'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>He didn't come looking for trouble, but troubl...</td>\n",
       "      <td>El Mariachi</td>\n",
       "      <td>6.6</td>\n",
       "      <td>238</td>\n",
       "      <td>El Mariachi</td>\n",
       "      <td>Carlos Gallardo, Jaime de Hoyos, Peter Marquar...</td>\n",
       "      <td>[{'credit_id': '52fe44eec3a36847f80b280b', 'de...</td>\n",
       "      <td>Robert Rodriguez</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4799</th>\n",
       "      <td>9000</td>\n",
       "      <td>Comedy, Romance</td>\n",
       "      <td>NaN</td>\n",
       "      <td>72766</td>\n",
       "      <td></td>\n",
       "      <td>en</td>\n",
       "      <td>Newlyweds</td>\n",
       "      <td>A newlywed couple's honeymoon is upended by th...</td>\n",
       "      <td>0.642552</td>\n",
       "      <td>[]</td>\n",
       "      <td>...</td>\n",
       "      <td>[]</td>\n",
       "      <td>Released</td>\n",
       "      <td>A newlywed couple's honeymoon is upended by th...</td>\n",
       "      <td>Newlyweds</td>\n",
       "      <td>5.9</td>\n",
       "      <td>5</td>\n",
       "      <td>Newlyweds</td>\n",
       "      <td>Edward Burns, Kerry Bishé, Marsha Dietlein, Ca...</td>\n",
       "      <td>[{'credit_id': '52fe487dc3a368484e0fb013', 'de...</td>\n",
       "      <td>Edward Burns</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4800</th>\n",
       "      <td>0</td>\n",
       "      <td>Comedy, Drama, Romance, TV Movie</td>\n",
       "      <td>http://www.hallmarkchannel.com/signedsealeddel...</td>\n",
       "      <td>231617</td>\n",
       "      <td>date, love at first sight, narration, investig...</td>\n",
       "      <td>en</td>\n",
       "      <td>Signed, Sealed, Delivered</td>\n",
       "      <td>\"Signed, Sealed, Delivered\" introduces a dedic...</td>\n",
       "      <td>1.444476</td>\n",
       "      <td>[{'name': 'Front Street Pictures', 'id': 3958}...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Signed, Sealed, Delivered</td>\n",
       "      <td>7.0</td>\n",
       "      <td>6</td>\n",
       "      <td>Signed, Sealed, Delivered</td>\n",
       "      <td>Eric Mabius, Kristin Booth, Crystal Lowe, Geof...</td>\n",
       "      <td>[{'credit_id': '52fe4df3c3a36847f8275ecf', 'de...</td>\n",
       "      <td>Scott Smith</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4801</th>\n",
       "      <td>0</td>\n",
       "      <td></td>\n",
       "      <td>http://shanghaicalling.com/</td>\n",
       "      <td>126186</td>\n",
       "      <td></td>\n",
       "      <td>en</td>\n",
       "      <td>Shanghai Calling</td>\n",
       "      <td>When ambitious New York attorney Sam is sent t...</td>\n",
       "      <td>0.857008</td>\n",
       "      <td>[]</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>A New Yorker in Shanghai</td>\n",
       "      <td>Shanghai Calling</td>\n",
       "      <td>5.7</td>\n",
       "      <td>7</td>\n",
       "      <td>Shanghai Calling</td>\n",
       "      <td>Daniel Henney, Eliza Coupe, Bill Paxton, Alan ...</td>\n",
       "      <td>[{'credit_id': '52fe4ad9c3a368484e16a36b', 'de...</td>\n",
       "      <td>Daniel Hsia</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4802</th>\n",
       "      <td>0</td>\n",
       "      <td>Documentary</td>\n",
       "      <td>NaN</td>\n",
       "      <td>25975</td>\n",
       "      <td>obsession, camcorder, crush, dream girl</td>\n",
       "      <td>en</td>\n",
       "      <td>My Date with Drew</td>\n",
       "      <td>Ever since the second grade when he first saw ...</td>\n",
       "      <td>1.929883</td>\n",
       "      <td>[{'name': 'rusty bear entertainment', 'id': 87...</td>\n",
       "      <td>...</td>\n",
       "      <td>[{'iso_639_1': 'en', 'name': 'English'}]</td>\n",
       "      <td>Released</td>\n",
       "      <td>NaN</td>\n",
       "      <td>My Date with Drew</td>\n",
       "      <td>6.3</td>\n",
       "      <td>16</td>\n",
       "      <td>My Date with Drew</td>\n",
       "      <td>Drew Barrymore, Brian Herzlinger, Corey Feldma...</td>\n",
       "      <td>[{'credit_id': '58ce021b9251415a390165d9', 'de...</td>\n",
       "      <td>Brian Herzlinger</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>4803 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         budget                                       genres  \\\n",
       "0     237000000  Action, Adventure, Fantasy, Science Fiction   \n",
       "1     300000000                   Adventure, Fantasy, Action   \n",
       "2     245000000                     Action, Adventure, Crime   \n",
       "3     250000000               Action, Crime, Drama, Thriller   \n",
       "4     260000000           Action, Adventure, Science Fiction   \n",
       "...         ...                                          ...   \n",
       "4798     220000                      Action, Crime, Thriller   \n",
       "4799       9000                              Comedy, Romance   \n",
       "4800          0             Comedy, Drama, Romance, TV Movie   \n",
       "4801          0                                                \n",
       "4802          0                                  Documentary   \n",
       "\n",
       "                                               homepage  movie_id  \\\n",
       "0                           http://www.avatarmovie.com/     19995   \n",
       "1          http://disney.go.com/disneypictures/pirates/       285   \n",
       "2           http://www.sonypictures.com/movies/spectre/    206647   \n",
       "3                    http://www.thedarkknightrises.com/     49026   \n",
       "4                  http://movies.disney.com/john-carter     49529   \n",
       "...                                                 ...       ...   \n",
       "4798                                                NaN      9367   \n",
       "4799                                                NaN     72766   \n",
       "4800  http://www.hallmarkchannel.com/signedsealeddel...    231617   \n",
       "4801                        http://shanghaicalling.com/    126186   \n",
       "4802                                                NaN     25975   \n",
       "\n",
       "                                               keywords original_language  \\\n",
       "0     culture clash, future, space war, space colony...                en   \n",
       "1     ocean, drug abuse, exotic island, east india t...                en   \n",
       "2        spy, based on novel, secret agent, sequel, mi6                en   \n",
       "3     dc comics, crime fighter, terrorist, secret id...                en   \n",
       "4     based on novel, mars, medallion, space travel,...                en   \n",
       "...                                                 ...               ...   \n",
       "4798  united states–mexico barrier, legs, arms, pape...                es   \n",
       "4799                                                                   en   \n",
       "4800  date, love at first sight, narration, investig...                en   \n",
       "4801                                                                   en   \n",
       "4802            obsession, camcorder, crush, dream girl                en   \n",
       "\n",
       "                                original_title  \\\n",
       "0                                       Avatar   \n",
       "1     Pirates of the Caribbean: At World's End   \n",
       "2                                      Spectre   \n",
       "3                        The Dark Knight Rises   \n",
       "4                                  John Carter   \n",
       "...                                        ...   \n",
       "4798                               El Mariachi   \n",
       "4799                                 Newlyweds   \n",
       "4800                 Signed, Sealed, Delivered   \n",
       "4801                          Shanghai Calling   \n",
       "4802                         My Date with Drew   \n",
       "\n",
       "                                               overview  popularity  \\\n",
       "0     In the 22nd century, a paraplegic Marine is di...  150.437577   \n",
       "1     Captain Barbossa, long believed to be dead, ha...  139.082615   \n",
       "2     A cryptic message from Bond’s past sends him o...  107.376788   \n",
       "3     Following the death of District Attorney Harve...  112.312950   \n",
       "4     John Carter is a war-weary, former military ca...   43.926995   \n",
       "...                                                 ...         ...   \n",
       "4798  El Mariachi just wants to play his guitar and ...   14.269792   \n",
       "4799  A newlywed couple's honeymoon is upended by th...    0.642552   \n",
       "4800  \"Signed, Sealed, Delivered\" introduces a dedic...    1.444476   \n",
       "4801  When ambitious New York attorney Sam is sent t...    0.857008   \n",
       "4802  Ever since the second grade when he first saw ...    1.929883   \n",
       "\n",
       "                                   production_companies  ...  \\\n",
       "0     [{'name': 'Ingenious Film Partners', 'id': 289...  ...   \n",
       "1     [{'name': 'Walt Disney Pictures', 'id': 2}, {'...  ...   \n",
       "2     [{'name': 'Columbia Pictures', 'id': 5}, {'nam...  ...   \n",
       "3     [{'name': 'Legendary Pictures', 'id': 923}, {'...  ...   \n",
       "4           [{'name': 'Walt Disney Pictures', 'id': 2}]  ...   \n",
       "...                                                 ...  ...   \n",
       "4798           [{'name': 'Columbia Pictures', 'id': 5}]  ...   \n",
       "4799                                                 []  ...   \n",
       "4800  [{'name': 'Front Street Pictures', 'id': 3958}...  ...   \n",
       "4801                                                 []  ...   \n",
       "4802  [{'name': 'rusty bear entertainment', 'id': 87...  ...   \n",
       "\n",
       "                                       spoken_languages    status  \\\n",
       "0     [{'iso_639_1': 'en', 'name': 'English'}, {'iso...  Released   \n",
       "1              [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "2     [{'iso_639_1': 'fr', 'name': 'Français'}, {'is...  Released   \n",
       "3              [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "4              [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "...                                                 ...       ...   \n",
       "4798           [{'iso_639_1': 'es', 'name': 'Español'}]  Released   \n",
       "4799                                                 []  Released   \n",
       "4800           [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "4801           [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "4802           [{'iso_639_1': 'en', 'name': 'English'}]  Released   \n",
       "\n",
       "                                                tagline  \\\n",
       "0                           Enter the World of Pandora.   \n",
       "1        At the end of the world, the adventure begins.   \n",
       "2                                 A Plan No One Escapes   \n",
       "3                                       The Legend Ends   \n",
       "4                  Lost in our world, found in another.   \n",
       "...                                                 ...   \n",
       "4798  He didn't come looking for trouble, but troubl...   \n",
       "4799  A newlywed couple's honeymoon is upended by th...   \n",
       "4800                                                NaN   \n",
       "4801                           A New Yorker in Shanghai   \n",
       "4802                                                NaN   \n",
       "\n",
       "                                       title_x vote_average vote_count  \\\n",
       "0                                       Avatar          7.2      11800   \n",
       "1     Pirates of the Caribbean: At World's End          6.9       4500   \n",
       "2                                      Spectre          6.3       4466   \n",
       "3                        The Dark Knight Rises          7.6       9106   \n",
       "4                                  John Carter          6.1       2124   \n",
       "...                                        ...          ...        ...   \n",
       "4798                               El Mariachi          6.6        238   \n",
       "4799                                 Newlyweds          5.9          5   \n",
       "4800                 Signed, Sealed, Delivered          7.0          6   \n",
       "4801                          Shanghai Calling          5.7          7   \n",
       "4802                         My Date with Drew          6.3         16   \n",
       "\n",
       "                                       title_y  \\\n",
       "0                                       Avatar   \n",
       "1     Pirates of the Caribbean: At World's End   \n",
       "2                                      Spectre   \n",
       "3                        The Dark Knight Rises   \n",
       "4                                  John Carter   \n",
       "...                                        ...   \n",
       "4798                               El Mariachi   \n",
       "4799                                 Newlyweds   \n",
       "4800                 Signed, Sealed, Delivered   \n",
       "4801                          Shanghai Calling   \n",
       "4802                         My Date with Drew   \n",
       "\n",
       "                                                   cast  \\\n",
       "0     Sam Worthington, Zoe Saldana, Sigourney Weaver...   \n",
       "1     Johnny Depp, Orlando Bloom, Keira Knightley, S...   \n",
       "2     Daniel Craig, Christoph Waltz, Léa Seydoux, Ra...   \n",
       "3     Christian Bale, Michael Caine, Gary Oldman, An...   \n",
       "4     Taylor Kitsch, Lynn Collins, Samantha Morton, ...   \n",
       "...                                                 ...   \n",
       "4798  Carlos Gallardo, Jaime de Hoyos, Peter Marquar...   \n",
       "4799  Edward Burns, Kerry Bishé, Marsha Dietlein, Ca...   \n",
       "4800  Eric Mabius, Kristin Booth, Crystal Lowe, Geof...   \n",
       "4801  Daniel Henney, Eliza Coupe, Bill Paxton, Alan ...   \n",
       "4802  Drew Barrymore, Brian Herzlinger, Corey Feldma...   \n",
       "\n",
       "                                                   crew           director  \n",
       "0     [{'credit_id': '52fe48009251416c750aca23', 'de...      James Cameron  \n",
       "1     [{'credit_id': '52fe4232c3a36847f800b579', 'de...     Gore Verbinski  \n",
       "2     [{'credit_id': '54805967c3a36829b5002c41', 'de...         Sam Mendes  \n",
       "3     [{'credit_id': '52fe4781c3a36847f81398c3', 'de...  Christopher Nolan  \n",
       "4     [{'credit_id': '52fe479ac3a36847f813eaa3', 'de...     Andrew Stanton  \n",
       "...                                                 ...                ...  \n",
       "4798  [{'credit_id': '52fe44eec3a36847f80b280b', 'de...   Robert Rodriguez  \n",
       "4799  [{'credit_id': '52fe487dc3a368484e0fb013', 'de...       Edward Burns  \n",
       "4800  [{'credit_id': '52fe4df3c3a36847f8275ecf', 'de...        Scott Smith  \n",
       "4801  [{'credit_id': '52fe4ad9c3a368484e16a36b', 'de...        Daniel Hsia  \n",
       "4802  [{'credit_id': '58ce021b9251415a390165d9', 'de...   Brian Herzlinger  \n",
       "\n",
       "[4803 rows x 24 columns]"
      ]
     },
     "execution_count": 89,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "kaggle_movs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "aabb6f82-c4ad-4f7d-8b36-26e010a2dcac",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'kaggle_movs' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[1], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m kaggle_movs\u001b[38;5;241m.\u001b[39mto_parquet(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m../tmbd_exports/tmbd_5000_merged.parquet\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "\u001b[1;31mNameError\u001b[0m: name 'kaggle_movs' is not defined"
     ]
    }
   ],
   "source": [
    "kaggle_movs.to_parquet(\"../tmbd_exports/tmbd_5000_merged.parquet\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
